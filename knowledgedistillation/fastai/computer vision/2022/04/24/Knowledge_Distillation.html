<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="twitter:card" content="summary_large_image" /><!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Knowledge Distillation for Traffic Sign Recognition | Deep Diving</title>
<meta name="generator" content="Jekyll v4.1.1" />
<meta property="og:title" content="Knowledge Distillation for Traffic Sign Recognition" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="This is the second part of the post ResNet for Traffic Sign Classification With PyTorch, in which we will try to get close to the results of the previous model but with a smaller one. To do so we will apply the knowledge distillation technique, want to know more? Let‚Äôs dive in!" />
<meta property="og:description" content="This is the second part of the post ResNet for Traffic Sign Classification With PyTorch, in which we will try to get close to the results of the previous model but with a smaller one. To do so we will apply the knowledge distillation technique, want to know more? Let‚Äôs dive in!" />
<link rel="canonical" href="https://xanaga.github.io/posts_en/knowledgedistillation/fastai/computer%20vision/2022/04/24/Knowledge_Distillation.html" />
<meta property="og:url" content="https://xanaga.github.io/posts_en/knowledgedistillation/fastai/computer%20vision/2022/04/24/Knowledge_Distillation.html" />
<meta property="og:site_name" content="Deep Diving" />
<meta property="og:image" content="https://xanaga.github.io/posts_en/images/compress.jpg" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2022-04-24T00:00:00-05:00" />
<meta name="twitter:card" content="summary_large_image" />
<meta property="twitter:image" content="https://xanaga.github.io/posts_en/images/compress.jpg" />
<meta property="twitter:title" content="Knowledge Distillation for Traffic Sign Recognition" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2022-04-24T00:00:00-05:00","datePublished":"2022-04-24T00:00:00-05:00","description":"This is the second part of the post ResNet for Traffic Sign Classification With PyTorch, in which we will try to get close to the results of the previous model but with a smaller one. To do so we will apply the knowledge distillation technique, want to know more? Let‚Äôs dive in!","headline":"Knowledge Distillation for Traffic Sign Recognition","image":"https://xanaga.github.io/posts_en/images/compress.jpg","mainEntityOfPage":{"@type":"WebPage","@id":"https://xanaga.github.io/posts_en/knowledgedistillation/fastai/computer%20vision/2022/04/24/Knowledge_Distillation.html"},"url":"https://xanaga.github.io/posts_en/knowledgedistillation/fastai/computer%20vision/2022/04/24/Knowledge_Distillation.html"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/posts_en/assets/css/style.css"><link type="application/atom+xml" rel="alternate" href="https://xanaga.github.io/posts_en/feed.xml" title="Deep Diving" /><link rel="shortcut icon" type="image/x-icon" href="/posts_en/images/favicon.ico"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/Primer/15.2.0/primer.css" integrity="sha512-xTz2ys4coGAOz8vuV1NcQBkgVmKhsSEtjbqyMJbBHRplFuvKIUo6xhLHpAyPt9mfR6twHJgn9OgVLuqOvjeBhg==" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.14.0/css/all.min.css" integrity="sha512-1PKOgIY59xJ8Co8+NE6FZ+LOAZKjy+KY8iq0G4B3CyeY6wYHN3yt9PW0XpSriVlkMXe40PTKnXrLnZ9+fkDaog==" crossorigin="anonymous" />

<script>
function wrap_img(fn) {
    if (document.attachEvent ? document.readyState === "complete" : document.readyState !== "loading") {
        var elements = document.querySelectorAll(".post img");
        Array.prototype.forEach.call(elements, function(el, i) {
            if (el.getAttribute("title") && (el.className != "emoji")) {
                const caption = document.createElement('figcaption');
                var node = document.createTextNode(el.getAttribute("title"));
                caption.appendChild(node);
                const wrapper = document.createElement('figure');
                wrapper.className = 'image';
                el.parentNode.insertBefore(wrapper, el);
                el.parentNode.removeChild(el);
                wrapper.appendChild(el);
                wrapper.appendChild(caption);
            }
        });
    } else { document.addEventListener('DOMContentLoaded', fn); }
}
window.onload = wrap_img;
</script>

<script>
    document.addEventListener("DOMContentLoaded", function(){
    // add link icon to anchor tags
    var elem = document.querySelectorAll(".anchor-link")
    elem.forEach(e => (e.innerHTML = '<i class="fas fa-link fa-xs"></i>'));
    });
</script>
</head>
<body><header class="site-header">

  <div class="wrapper"><a class="site-title" rel="author" href="/posts_en/">Deep Diving</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/posts_en/about/">About Me</a><a class="page-link" href="/posts_en/search/">Search</a><a class="page-link" href="/posts_en/categories/">Tags</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">Knowledge Distillation for Traffic Sign Recognition</h1><p class="page-description">This is the second part of the post **ResNet for Traffic Sign Classification With PyTorch**, in which we will try to get close to the results of the previous model but with a smaller one. To do so we will apply the knowledge distillation technique, want to know more? Let's dive in!</p><p class="post-meta post-meta-title"><time class="dt-published" datetime="2022-04-24T00:00:00-05:00" itemprop="datePublished">
        Apr 24, 2022
      </time>
       ‚Ä¢ <span class="read-time" title="Estimated read time">
    
    
      27 min read
    
</span></p>

    
      <p class="category-tags"><i class="fas fa-tags category-tags-icon"></i></i> 
      
        <a class="category-tags-link" href="/posts_en/categories/#knowledgeDistillation">knowledgeDistillation</a>
        &nbsp;
      
        <a class="category-tags-link" href="/posts_en/categories/#fastai">fastai</a>
        &nbsp;
      
        <a class="category-tags-link" href="/posts_en/categories/#computer vision">computer vision</a>
        
      
      </p>
    

    
      
        <div class="pb-5 d-flex flex-justify-center">
          <div class="px-2">

    <a href="https://github.com/XanaGA/posts_en/tree/master/_notebooks/2022-04-24-Knowledge_Distillation.ipynb" role="button" target="_blank">
<img class="notebook-badge-image" src="/posts_en/assets/badges/github.svg" alt="View On GitHub">
    </a>
</div>

          <div class="px-2">
    <a href="https://mybinder.org/v2/gh/XanaGA/posts_en/master?filepath=_notebooks%2F2022-04-24-Knowledge_Distillation.ipynb" target="_blank">
        <img class="notebook-badge-image" src="/posts_en/assets/badges/binder.svg" alt="Open In Binder"/>
    </a>
</div>

          <div class="px-2">
    <a href="https://colab.research.google.com/github/XanaGA/posts_en/blob/master/_notebooks/2022-04-24-Knowledge_Distillation.ipynb" target="_blank">
        <img class="notebook-badge-image" src="/posts_en/assets/badges/colab.svg" alt="Open In Colab"/>
    </a>
</div>
          <div class="px-2">
  <a href="https://deepnote.com/launch?url=https%3A%2F%2Fgithub.com%2FXanaGA%2Fposts_en%2Fblob%2Fmaster%2F_notebooks%2F2022-04-24-Knowledge_Distillation.ipynb" target="_blank">
      <img class="notebook-badge-image" src="/posts_en/assets/badges/deepnote.svg" alt="Launch in Deepnote"/>
  </a>
</div>

        </div>
      </header>

  <div class="post-content e-content" itemprop="articleBody">
    <ul id="toc" class="section-nav">
<li class="toc-entry toc-h1"><a href="#Introduction">Introduction </a></li>
<li class="toc-entry toc-h1"><a href="#Imports">Imports </a></li>
<li class="toc-entry toc-h1"><a href="#Download-the-datasets">Download the datasets </a></li>
<li class="toc-entry toc-h1"><a href="#Prepare-the-data">Prepare the data </a></li>
<li class="toc-entry toc-h1"><a href="#Knowledge-Distillation">Knowledge Distillation </a>
<ul>
<li class="toc-entry toc-h2"><a href="#The-teacher-model-üíº-üìè">The teacher model üíº üìè </a></li>
<li class="toc-entry toc-h2"><a href="#The-student-Learner-üìó">The student Learner üìó </a></li>
</ul>
</li>
<li class="toc-entry toc-h1"><a href="#Training">Training </a>
<ul>
<li class="toc-entry toc-h2"><a href="#Explore-training">Explore training </a></li>
<li class="toc-entry toc-h2"><a href="#Retrain-on-the-whole-dataset">Retrain on the whole dataset </a></li>
</ul>
</li>
<li class="toc-entry toc-h1"><a href="#Test">Test </a></li>
<li class="toc-entry toc-h1"><a href="#Conclusion">Conclusion </a></li>
</ul><!--
#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: _notebooks/2022-04-24-Knowledge_Distillation.ipynb
-->

<div class="container" id="notebook-container">
        
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><img src="/posts_en/images/copied_from_nb/my_icons/traffic/compress.jpg" alt=""></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Introduction">
<a class="anchor" href="#Introduction" aria-hidden="true"><span class="octicon octicon-link"></span></a>Introduction<a class="anchor-link" href="#Introduction"> </a>
</h1>
<p>It seems that the current trend in Deep Learning is to have bigger and more models. This makes it difficult for users to use them, fit them into small devices, get fast results etc. This is why I see model compression, knowledge distillation, and these kinds of techniques as one of the more interesting and useful topics in deep learning. After all, if you want to apply deep learning in VR/AR you need to fit them into small devices. Also for simulations and computer graphics is better to have optimized and fast models. In addition, this makes AI more affordable to everyone, democratizing access to this technology. <br>
With this objective in mind I tried to get similar results as in my <a href="https://xanaga.github.io/posts_en/fastai/computer%20vision/traffic%20sign/2022/04/21/ResNet_for_Traffic_Sign_Classification_With_PyTorch.html">previous post</a>, but using a resnet18 instead of a resnet34. Before continuing reading this post I encourage you to take a look at the previous one. Nevertheless, I was not successful at all. Looking for some solutions I discovered <a href="https://nathanhubens.github.io/fasterai/">FasterAI</a> by <a href="https://github.com/nathanhubens">Nathan Hubens</a>, which is an awesome library that implements those compression techniques based on Fastai.<br>
So my objectives with this notebook are:</p>
<ul>
<li>Try to implement Knowledge Distillation technique using FasterAI to start getting familiar with the library. I would like to apply this model compression to other projects too (but that will not be covered in this notebook)</li>
<li>Encourage anyone who is thinking about implementing these types of approaches that may seem complicated to try this library.</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Imports">
<a class="anchor" href="#Imports" aria-hidden="true"><span class="octicon octicon-link"></span></a>Imports<a class="anchor-link" href="#Imports"> </a>
</h1>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>First we will upgrade the fastai version used in Colab, by deafult it is the first version.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="err">!</span> <span class="n">pip</span> <span class="n">install</span> <span class="o">-</span><span class="n">Uqq</span> <span class="n">fastai</span>   <span class="c1"># upgrade fastai on colab</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="o">%</span><span class="n">reload_ext</span> <span class="n">autoreload</span>
<span class="o">%</span><span class="n">autoreload</span> <span class="mi">2</span>
<span class="o">%</span><span class="n">matplotlib</span> <span class="n">inline</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="kn">import</span> <span class="nn">fastai</span>
<span class="n">fastai</span><span class="o">.</span><span class="n">__version__</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>'2.5.6'</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="kn">from</span> <span class="nn">fastai.imports</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">fastai.basics</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">fastai.vision.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">fastai.callback.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">fastai.data.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">fastai.vision.core</span> <span class="kn">import</span> <span class="n">PILImage</span>
<span class="kn">from</span> <span class="nn">PIL</span> <span class="kn">import</span> <span class="n">ImageOps</span>

<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">csv</span>
<span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">defaultdict</span><span class="p">,</span> <span class="n">namedtuple</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">shutil</span>

<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">confusion_matrix</span><span class="p">,</span> <span class="n">f1_score</span>

<span class="kn">import</span> <span class="nn">torch</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We will use the following variable to tell Pytorch to allocate the tensors into the GPU if we have access to one. If not, all the processing will be made on the CPU (NOT recommended, it will be very slow)</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="n">device</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">device</span><span class="p">(</span><span class="s2">"cuda:0"</span> <span class="k">if</span> <span class="n">torch</span><span class="o">.</span><span class="n">cuda</span><span class="o">.</span><span class="n">is_available</span><span class="p">()</span> <span class="k">else</span> <span class="s2">"cpu"</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Download-the-datasets">
<a class="anchor" href="#Download-the-datasets" aria-hidden="true"><span class="octicon octicon-link"></span></a>Download the datasets<a class="anchor-link" href="#Download-the-datasets"> </a>
</h1>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>This will be analogous to the Download section in the previous post. Despite that, I have added the possibility to only train on some classes of the dataset. Because of using Knowledge Distillation we should be able to classify signals that never have been seen in the training set (or at least give an informed guess). For this notebook, we will use all the classes, but you are encouraged to try to eliminate some and see how it behaves!</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p></p>
<div class="flash flash-error">
    <svg class="octicon octicon-alert" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M8.22 1.754a.25.25 0 00-.44 0L1.698 13.132a.25.25 0 00.22.368h12.164a.25.25 0 00.22-.368L8.22 1.754zm-1.763-.707c.659-1.234 2.427-1.234 3.086 0l6.082 11.378A1.75 1.75 0 0114.082 15H1.918a1.75 1.75 0 01-1.543-2.575L6.457 1.047zM9 11a1 1 0 11-2 0 1 1 0 012 0zm-.25-5.25a.75.75 0 00-1.5 0v2.5a.75.75 0 001.5 0v-2.5z"></path></svg>
    <strong>Warning: </strong>Check the download links in case the dataset has been moved. For example, the links provided in Pavel‚Äôs blog post are no longer working. You can find all the versions released <a href="https://sid.erda.dk/public/archives/daaeac0d7ce1152aea9b61d9f1e19370/published-archive.html">here</a>.
</div>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="n">c</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">43</span><span class="p">))</span> <span class="c1"># List the classes you want to train on</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<details class="description">
      <summary class="btn btn-sm" data-open="Hide Code" data-close="Show Code"></summary>
        <p></p>
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="c1"># Download and unpack the training set and the test set</span>

<span class="err">!</span> <span class="n">wget</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">sid</span><span class="o">.</span><span class="n">erda</span><span class="o">.</span><span class="n">dk</span><span class="o">/</span><span class="n">public</span><span class="o">/</span><span class="n">archives</span><span class="o">/</span><span class="n">daaeac0d7ce1152aea9b61d9f1e19370</span><span class="o">/</span><span class="n">GTSRB_Final_Training_Images</span><span class="o">.</span><span class="n">zip</span> <span class="o">-</span><span class="n">P</span> <span class="n">data</span>
<span class="err">!</span> <span class="n">wget</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">sid</span><span class="o">.</span><span class="n">erda</span><span class="o">.</span><span class="n">dk</span><span class="o">/</span><span class="n">public</span><span class="o">/</span><span class="n">archives</span><span class="o">/</span><span class="n">daaeac0d7ce1152aea9b61d9f1e19370</span><span class="o">/</span><span class="n">GTSRB_Final_Test_Images</span><span class="o">.</span><span class="n">zip</span> <span class="o">-</span><span class="n">P</span> <span class="n">data</span>
<span class="err">!</span> <span class="n">wget</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">sid</span><span class="o">.</span><span class="n">erda</span><span class="o">.</span><span class="n">dk</span><span class="o">/</span><span class="n">public</span><span class="o">/</span><span class="n">archives</span><span class="o">/</span><span class="n">daaeac0d7ce1152aea9b61d9f1e19370</span><span class="o">/</span><span class="n">GTSRB_Final_Test_GT</span><span class="o">.</span><span class="n">zip</span> <span class="o">-</span><span class="n">P</span> <span class="n">data</span>
<span class="err">!</span> <span class="n">unzip</span> <span class="n">data</span><span class="o">/</span><span class="n">GTSRB_Final_Training_Images</span><span class="o">.</span><span class="n">zip</span> <span class="o">-</span><span class="n">d</span> <span class="n">data</span>
<span class="err">!</span> <span class="n">unzip</span> <span class="n">data</span><span class="o">/</span><span class="n">GTSRB_Final_Test_Images</span><span class="o">.</span><span class="n">zip</span> <span class="o">-</span><span class="n">d</span> <span class="n">data</span>
<span class="err">!</span> <span class="n">unzip</span> <span class="n">data</span><span class="o">/</span><span class="n">GTSRB_Final_Test_GT</span><span class="o">.</span><span class="n">zip</span> <span class="o">-</span><span class="n">d</span> <span class="n">data</span>

<span class="c1"># Move the test set to data/test</span>

<span class="err">!</span> <span class="n">mkdir</span> <span class="n">data</span><span class="o">/</span><span class="n">test</span>
<span class="err">!</span> <span class="n">mv</span> <span class="n">data</span><span class="o">/</span><span class="n">GTSRB</span><span class="o">/</span><span class="n">Final_Test</span><span class="o">/</span><span class="n">Images</span><span class="o">/*.</span><span class="n">ppm</span> <span class="n">data</span><span class="o">/</span><span class="n">test</span>

<span class="c1"># Download class names</span>
<span class="err">!</span> <span class="n">wget</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">raw</span><span class="o">.</span><span class="n">githubusercontent</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">georgesung</span><span class="o">/</span><span class="n">traffic_sign_classification_german</span><span class="o">/</span><span class="n">master</span><span class="o">/</span><span class="n">signnames</span><span class="o">.</span><span class="n">csv</span> <span class="o">-</span><span class="n">P</span> <span class="n">data</span>
</pre></div>

    </div>
</div>
</div>

    </details>
</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The following are some functions and code used to organize and divide our data into training, validation and test set. It is analogous to the process made in the resnet34 notebook, with some minor changes to handle the cases where not all the classes are selected. A more detailed explanation can be found in the <a href="https://xanaga.github.io/posts_en/fastai/computer%20vision/traffic%20sign/2022/04/21/ResNet_for_Traffic_Sign_Classification_With_PyTorch.html">previous post</a>.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We have changed the <code>read_annotations</code> function to allow us to filter and read only the annotations of the classes we are interested in. This is done by adding the <code>if</code> inside the <code>for</code> loop. So the <em>classes</em> will have to be passed as an argument in all the following functions.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="n">Annotation</span> <span class="o">=</span> <span class="n">namedtuple</span><span class="p">(</span><span class="s1">'Annotation'</span><span class="p">,</span> <span class="p">[</span><span class="s1">'filename'</span><span class="p">,</span> <span class="s1">'label'</span><span class="p">])</span>

<span class="k">def</span> <span class="nf">read_annotations</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">classes</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="n">annotations</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">reader</span> <span class="o">=</span> <span class="n">csv</span><span class="o">.</span><span class="n">reader</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="s1">';'</span><span class="p">)</span>
        <span class="nb">next</span><span class="p">(</span><span class="n">reader</span><span class="p">)</span> <span class="c1"># skip header</span>

        <span class="c1"># loop over all images in current annotations file</span>
        <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">reader</span><span class="p">:</span>
            <span class="n">filename</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="c1"># filename is in the 0th column</span>
            <span class="n">label</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="mi">7</span><span class="p">])</span> <span class="c1"># label is in the 7th column</span>
            <span class="k">if</span> <span class="n">classes</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">label</span> <span class="ow">in</span> <span class="n">classes</span><span class="p">:</span> <span class="c1"># We only read the annotations of the classes we are interested</span>
              <span class="n">annotations</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Annotation</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">label</span><span class="p">))</span> 
            
    <span class="k">return</span> <span class="n">annotations</span>


<span class="k">def</span> <span class="nf">load_training_annotations</span><span class="p">(</span><span class="n">source_path</span><span class="p">,</span> <span class="n">classes</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="n">annotations</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">43</span><span class="p">):</span>
        <span class="n">filename</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">source_path</span><span class="p">,</span> <span class="nb">format</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="s1">'05d'</span><span class="p">),</span> <span class="s1">'GT-'</span> <span class="o">+</span> <span class="nb">format</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="s1">'05d'</span><span class="p">)</span> <span class="o">+</span> <span class="s1">'.csv'</span><span class="p">)</span>
        <span class="n">annotations</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">read_annotations</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">classes</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">annotations</span>


<span class="k">def</span> <span class="nf">copy_files</span><span class="p">(</span><span class="n">label</span><span class="p">,</span> <span class="n">filenames</span><span class="p">,</span> <span class="n">source</span><span class="p">,</span> <span class="n">destination</span><span class="p">,</span> <span class="n">classes</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">move</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="n">func</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">rename</span> <span class="k">if</span> <span class="n">move</span> <span class="k">else</span> <span class="n">shutil</span><span class="o">.</span><span class="n">copyfile</span>
    
    <span class="n">label_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">destination</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">label</span><span class="p">))</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">label_path</span><span class="p">):</span>
        <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">label_path</span><span class="p">)</span>
        
    <span class="k">for</span> <span class="n">filename</span> <span class="ow">in</span> <span class="n">filenames</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">classes</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="nb">int</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">label_path</span><span class="p">))</span> <span class="ow">in</span> <span class="n">classes</span><span class="p">:</span>
          <span class="n">destination_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">label_path</span><span class="p">,</span> <span class="n">filename</span><span class="p">)</span>
          <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">destination_path</span><span class="p">):</span>
              <span class="n">func</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="nb">format</span><span class="p">(</span><span class="n">label</span><span class="p">,</span> <span class="s1">'05d'</span><span class="p">),</span> <span class="n">filename</span><span class="p">),</span> <span class="n">destination_path</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">split_train_validation_sets</span><span class="p">(</span><span class="n">source_path</span><span class="p">,</span> <span class="n">train_path</span><span class="p">,</span> <span class="n">validation_path</span><span class="p">,</span> <span class="n">all_path</span><span class="p">,</span> <span class="n">classes</span><span class="p">,</span> <span class="n">validation_fraction</span><span class="o">=</span><span class="mf">0.2</span><span class="p">):</span>
    <span class="sd">"""</span>
<span class="sd">    Splits the GTSRB training set into training and validation sets.</span>
<span class="sd">    """</span>
    
    <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">train_path</span><span class="p">):</span>
        <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">train_path</span><span class="p">)</span>
        
    <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">validation_path</span><span class="p">):</span>
        <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">validation_path</span><span class="p">)</span>
        
    <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">all_path</span><span class="p">):</span>
        <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">all_path</span><span class="p">)</span>
    
    <span class="n">annotations</span> <span class="o">=</span> <span class="n">load_training_annotations</span><span class="p">(</span><span class="n">source_path</span><span class="p">)</span>
    <span class="n">filenames</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">list</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">annotation</span> <span class="ow">in</span> <span class="n">annotations</span><span class="p">:</span>
        <span class="n">filenames</span><span class="p">[</span><span class="n">annotation</span><span class="o">.</span><span class="n">label</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">annotation</span><span class="o">.</span><span class="n">filename</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">label</span><span class="p">,</span> <span class="n">filenames</span> <span class="ow">in</span> <span class="n">filenames</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="n">filenames</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">filenames</span><span class="p">)</span>
        
        <span class="n">validation_size</span> <span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">filenames</span><span class="p">)</span> <span class="o">//</span> <span class="mi">30</span> <span class="o">*</span> <span class="n">validation_fraction</span><span class="p">)</span> <span class="o">*</span> <span class="mi">30</span>
        <span class="n">train_filenames</span> <span class="o">=</span> <span class="n">filenames</span><span class="p">[</span><span class="n">validation_size</span><span class="p">:]</span>
        <span class="n">validation_filenames</span> <span class="o">=</span> <span class="n">filenames</span><span class="p">[:</span><span class="n">validation_size</span><span class="p">]</span>
        
        <span class="n">copy_files</span><span class="p">(</span><span class="n">label</span><span class="p">,</span> <span class="n">filenames</span><span class="p">,</span> <span class="n">source_path</span><span class="p">,</span> <span class="n">all_path</span><span class="p">,</span> <span class="n">classes</span><span class="p">,</span> <span class="n">move</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">copy_files</span><span class="p">(</span><span class="n">label</span><span class="p">,</span> <span class="n">train_filenames</span><span class="p">,</span> <span class="n">source_path</span><span class="p">,</span> <span class="n">train_path</span><span class="p">,</span> <span class="n">classes</span><span class="p">,</span> <span class="n">move</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">copy_files</span><span class="p">(</span><span class="n">label</span><span class="p">,</span> <span class="n">validation_filenames</span><span class="p">,</span> <span class="n">source_path</span><span class="p">,</span> <span class="n">validation_path</span><span class="p">,</span> <span class="n">classes</span><span class="p">,</span> <span class="n">move</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Due to the changes we have made in the previous functions we only have to add the information about the classes in the last step, passing it to the <code>split_train_validation_sets</code> function.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="n">path</span> <span class="o">=</span> <span class="s1">'data'</span>
<span class="n">source_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="s1">'GTSRB/Final_Training/Images'</span><span class="p">)</span>
<span class="n">train_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="s1">'train'</span><span class="p">)</span>
<span class="n">validation_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="s1">'valid'</span><span class="p">)</span>
<span class="n">all_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="s1">'all'</span><span class="p">)</span>
<span class="n">validation_fraction</span> <span class="o">=</span> <span class="mf">0.2</span>
<span class="n">split_train_validation_sets</span><span class="p">(</span><span class="n">source_path</span><span class="p">,</span> <span class="n">train_path</span><span class="p">,</span> <span class="n">validation_path</span><span class="p">,</span> <span class="n">all_path</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">validation_fraction</span><span class="p">)</span>

<span class="n">test_annotations</span> <span class="o">=</span> <span class="n">read_annotations</span><span class="p">(</span><span class="s1">'data/GT-final_test.csv'</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Prepare-the-data">
<a class="anchor" href="#Prepare-the-data" aria-hidden="true"><span class="octicon octicon-link"></span></a>Prepare the data<a class="anchor-link" href="#Prepare-the-data"> </a>
</h1>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Data preparation is even more similar to the <a href="https://xanaga.github.io/posts_en/fastai/computer%20vision/traffic%20sign/2022/04/21/ResNet_for_Traffic_Sign_Classification_With_PyTorch.html">previous post</a>. We will only add a <em>vocab</em> when creating the dataset. This is because if we don't specify it Fastai will take as <em>vocab</em> the classes that appear in our data, which would be problematic if we want to restrict the problem to only a subset of classes.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="n">classes</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">'data/signnames.csv'</span><span class="p">)</span>
<span class="n">class_names</span> <span class="o">=</span> <span class="p">{}</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">classes</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
    <span class="n">class_names</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="mi">0</span><span class="p">])]</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="n">sz</span> <span class="o">=</span> <span class="mi">96</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">ImageDataLoaders</span><span class="o">.</span><span class="n">from_folder</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">item_tfms</span><span class="o">=</span><span class="p">[</span><span class="n">Resize</span><span class="p">(</span><span class="n">sz</span><span class="p">,</span><span class="n">order</span><span class="o">=</span><span class="mi">0</span><span class="p">)],</span> <span class="n">bs</span><span class="o">=</span><span class="mi">256</span><span class="p">,</span> 
                                    <span class="n">batch_tfms</span><span class="o">=</span><span class="p">[</span><span class="o">*</span><span class="n">aug_transforms</span><span class="p">(</span><span class="n">do_flip</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                                              <span class="n">max_zoom</span><span class="o">=</span><span class="mf">1.2</span><span class="p">,</span>
                                                              <span class="n">max_rotate</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
                                                              <span class="n">max_lighting</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span>
                                                              <span class="n">p_lighting</span><span class="o">=</span><span class="mf">0.8</span><span class="p">),</span>
                                                <span class="n">Normalize</span><span class="o">.</span><span class="n">from_stats</span><span class="p">(</span><span class="o">*</span><span class="n">imagenet_stats</span><span class="p">)],</span>
                                    <span class="n">vocab</span><span class="o">=</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">43</span><span class="p">)])</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We can see that our <em>vocab</em> will have all the classes, no matter which classes we use to train.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="n">data</span><span class="o">.</span><span class="n">vocab</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>['0', '1', '10', '11', '12', '13', '14', '15', '16', '17', '18', '19', '2', '20', '21', '22', '23', '24', '25', '26', '27', '28', '29', '3', '30', '31', '32', '33', '34', '35', '36', '37', '38', '39', '4', '40', '41', '42', '5', '6', '7', '8', '9']</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Knowledge-Distillation">
<a class="anchor" href="#Knowledge-Distillation" aria-hidden="true"><span class="octicon octicon-link"></span></a>Knowledge Distillation<a class="anchor-link" href="#Knowledge-Distillation"> </a>
</h1>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>This is a technique proposed by Geoffrey E. Hinton as a way to extract the knowledge from big models and use it to train simpler architectures. Moreover, it also has proven to provide what seems to be more robust and general learning which is always desirable. We have considered this approach because of the increasing size of the models not only in computer vision tasks but also in Natural Language Processing (NLP), which makes those difficult to be used in inference for very time demanding tasks or even impossible to fit in embedded systems.</p>
<p>The <strong>high-level idea</strong> is to, instead of training the models with one-hot encoded vectors, train them using a ‚Äúsofter version‚Äù of those that stores some information about the similarity between images. Is a concept similar to word embeddings in NLP.  These labels are obtained from (normally) a bigger model which is already trained and used only for inference.</p>
<p>Here is where we start using <strong>FasterAI</strong> library. Nevertheless, I found problems loading a model into a learner with Fastai. As <code>KnowledgeDistillation</code> function expects to receive a learner I had to copy and paste this function and modify it by adding the <code>from_learner</code> parameter. In this way, I can set it to false and use as a teacher a plain PyTorch model. Nevertheless, the correct way of using it would be as straightforward as installing the library:</p>
<p><code>pip install fasterai</code></p>
<p>And import the things you need:</p>
<p><code>from fasterai import ...</code></p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="n">sz</span> <span class="o">=</span> <span class="mi">96</span>
<span class="n">bs</span> <span class="o">=</span> <span class="mi">256</span>
<span class="n">wd</span> <span class="o">=</span> <span class="mf">5e-3</span>
<span class="n">f1_score_mult</span> <span class="o">=</span> <span class="n">FBeta</span><span class="p">(</span><span class="n">beta</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">average</span><span class="o">=</span><span class="s1">'weighted'</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>To act as the teacher we will use the model we trained in the <a href="https://xanaga.github.io/posts_en/fastai/computer%20vision/traffic%20sign/2022/04/21/ResNet_for_Traffic_Sign_Classification_With_PyTorch.html">previous post</a> which can be found in this <a href="https://github.com/XanaGA/models/tree/master/traffic">repo</a>. You can download it from there or train your own model using the previous notebook. Once you have the model trained you will have to set the <code>path_to_model</code> variable.</p>
<p>If you are working in Colab you can drag and drop the model into the Colab's file explorer or save the model in your drive and mount it (just by clicking the <em>Mount Drive</em> button in the <em>files</em> tab, on the left in Colab). By mounting the drive you will be able to reach the model file by navigating across your drive directories.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="n">path_to_model</span> <span class="o">=</span> <span class="s1">'drive/MyDrive/AleXavi/SistemasInteligentes/MLP_report/'</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="The-teacher-model-üíº-üìè">
<a class="anchor" href="#The-teacher-model-%F0%9F%92%BC-%F0%9F%93%8F" aria-hidden="true"><span class="octicon octicon-link"></span></a>The teacher model üíº üìè<a class="anchor-link" href="#The-teacher-model-%F0%9F%92%BC-%F0%9F%93%8F"> </a>
</h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>First, we prepare the teacher model. To do so, we will get the architecture of our model with random weights and then we will fill it with the trained weights.
</p>
<div class="flash flash-warn">
    <svg class="octicon octicon-zap" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M10.561 1.5a.016.016 0 00-.01.004L3.286 8.571A.25.25 0 003.462 9H6.75a.75.75 0 01.694 1.034l-1.713 4.188 6.982-6.793A.25.25 0 0012.538 7H9.25a.75.75 0 01-.683-1.06l2.008-4.418.003-.006a.02.02 0 00-.004-.009.02.02 0 00-.006-.006L10.56 1.5zM9.504.43a1.516 1.516 0 012.437 1.713L10.415 5.5h2.123c1.57 0 2.346 1.909 1.22 3.004l-7.34 7.142a1.25 1.25 0 01-.871.354h-.302a1.25 1.25 0 01-1.157-1.723L5.633 10.5H3.462c-1.57 0-2.346-1.909-1.22-3.004L9.503.429z"></path></svg>
    <strong>Important: </strong>To do that, is necessary that the <em>random filled architecture</em> has exactly the same parameters as the ones in the <em>pretrained</em> ones.
</div>
This is why we use <code>create_cnn_model</code> fuction of Fastai, which given a model architecture it creates a model (which is a Sequential object) with the head and the body that we choose. In the previous notebook we created the Learner with the default settings, so now we will use those defaults too. For each architecture, Fastai has a way of cutting the model, and for all of them it uses the same default head, you can check the <a href="https://github.com/fastai/fastai/blob/master/fastai/vision/learner.py#L138">source code</a>!
<p>If you would want to create the model with a different head and body you would have to use the <code>cut</code> and <code>custom_head</code> arguments. You can find more information about it in the <a href="https://docs.fast.ai/vision.learner.html#create_cnn_model">documentation</a>.</p>
<p>The <code>to_device</code> method will place it into GPU or CPU depending on the hardware available.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="n">teacher</span> <span class="o">=</span> <span class="n">create_cnn_model</span><span class="p">(</span><span class="n">resnet34</span><span class="p">,</span> <span class="mi">43</span><span class="p">,</span> <span class="n">pretrained</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span> <span class="c1">#get the model architecture</span>
<span class="n">teacher</span><span class="o">.</span><span class="n">load_state_dict</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">path_to_model</span><span class="o">+</span><span class="s1">'resnet34_weights.pth'</span><span class="p">))</span> <span class="c1">#load the trained wheights</span>
<span class="n">teacher</span>
</pre></div>

    </div>
</div>
</div>
<details class="description">
      <summary class="btn btn-sm" data-open="Hide Output" data-close="Show Output"></summary>
        <p>
</p>
<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>Sequential(
  (0): Sequential(
    (0): Conv2d(3, 64, kernel_size=(7, 7), stride=(2, 2), padding=(3, 3), bias=False)
    (1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): ReLU(inplace=True)
    (3): MaxPool2d(kernel_size=3, stride=2, padding=1, dilation=1, ceil_mode=False)
    (4): Sequential(
      (0): BasicBlock(
        (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
        (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (1): BasicBlock(
        (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
        (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (2): BasicBlock(
        (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
        (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (5): Sequential(
      (0): BasicBlock(
        (conv1): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
        (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
        (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (downsample): Sequential(
          (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
      )
      (1): BasicBlock(
        (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
        (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (2): BasicBlock(
        (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
        (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (3): BasicBlock(
        (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
        (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (6): Sequential(
      (0): BasicBlock(
        (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
        (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
        (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (downsample): Sequential(
          (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
      )
      (1): BasicBlock(
        (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
        (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (2): BasicBlock(
        (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
        (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (3): BasicBlock(
        (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
        (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (4): BasicBlock(
        (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
        (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (5): BasicBlock(
        (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
        (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (7): Sequential(
      (0): BasicBlock(
        (conv1): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
        (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
        (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (downsample): Sequential(
          (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
      )
      (1): BasicBlock(
        (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
        (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (2): BasicBlock(
        (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
        (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
  )
  (1): Sequential(
    (0): AdaptiveConcatPool2d(
      (ap): AdaptiveAvgPool2d(output_size=1)
      (mp): AdaptiveMaxPool2d(output_size=1)
    )
    (1): Flatten(full=False)
    (2): BatchNorm1d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (3): Dropout(p=0.25, inplace=False)
    (4): Linear(in_features=1024, out_features=512, bias=False)
    (5): ReLU(inplace=True)
    (6): BatchNorm1d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (7): Dropout(p=0.5, inplace=False)
    (8): Linear(in_features=512, out_features=43, bias=False)
  )
)</pre>
</div>

</div>

</div>
</div>

    </details>
</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p></p>
<div class="flash">
    <svg class="octicon octicon-info" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M8 1.5a6.5 6.5 0 100 13 6.5 6.5 0 000-13zM0 8a8 8 0 1116 0A8 8 0 010 8zm6.5-.25A.75.75 0 017.25 7h1a.75.75 0 01.75.75v2.75h.25a.75.75 0 010 1.5h-2a.75.75 0 010-1.5h.25v-2h-.25a.75.75 0 01-.75-.75zM8 6a1 1 0 100-2 1 1 0 000 2z"></path></svg>
    <strong>Note: </strong>The <code>teacher</code> is a Sequential object with two modules. The module <code>(0)</code> is the <strong>body</strong>, and it is the original architecture of the model (in our case resnet34), which can be pretrained (not in our case). The second module, the <code>(1): Sequential</code>, is the <strong>head</strong> which is initialized using <code>kaiming_normal</code> initialization by default(it can be changed using the <code>init</code> argument), so it is not pretrained. The layers of this <strong>head</strong> are the default used in Fastai. The decision about where to <em>cut</em> the original model is taken according to Fastai metadata for each architecture, but as we have said it is customizable using the <code>cut</code> argument.
</div>
Our teacher model is almost ready! The only thing that last is that, as we don't want to propagate gradients through our teacher (we only want it for inference) we should make sure it is frozen.
<p>The following PyTorch code does exactly that.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="k">for</span> <span class="n">param</span> <span class="ow">in</span> <span class="n">teacher</span><span class="o">.</span><span class="n">parameters</span><span class="p">():</span>
    <span class="n">param</span><span class="o">.</span><span class="n">requires_grad</span> <span class="o">=</span> <span class="kc">False</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p></p>
<div class="flash">
    <svg class="octicon octicon-info" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M8 1.5a6.5 6.5 0 100 13 6.5 6.5 0 000-13zM0 8a8 8 0 1116 0A8 8 0 010 8zm6.5-.25A.75.75 0 017.25 7h1a.75.75 0 01.75.75v2.75h.25a.75.75 0 010 1.5h-2a.75.75 0 010-1.5h.25v-2h-.25a.75.75 0 01-.75-.75zM8 6a1 1 0 100-2 1 1 0 000 2z"></path></svg>
    <strong>Note: </strong>Inside the <code>KnowledgeDistillation</code> callback we use the teacher in <code>eval()</code> mode, so the gradients would not be calculated even if the model is not frozen, but is better to make sure.
</div>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="The-student-Learner-üìó">
<a class="anchor" href="#The-student-Learner-%F0%9F%93%97" aria-hidden="true"><span class="octicon octicon-link"></span></a>The student Learner üìó<a class="anchor-link" href="#The-student-Learner-%F0%9F%93%97"> </a>
</h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Now let's prepare our student network. As before we use the <code>create_cnn_model</code>, but with a pretrained resnet18 architecture, to build the model that we will pass to the Learner constructor.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="n">student_model</span><span class="o">=</span><span class="n">create_cnn_model</span><span class="p">(</span><span class="n">resnet18</span><span class="p">,</span> <span class="mi">43</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span> <span class="c1">#get the model architecture and pretrained wheights</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Then, we could do the following:</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="n">bad_student</span> <span class="o">=</span> <span class="n">Learner</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">student_model</span><span class="p">,</span> <span class="n">metrics</span><span class="o">=</span><span class="p">[</span><span class="n">accuracy</span><span class="p">,</span><span class="n">f1_score_mult</span><span class="p">])</span>
<span class="n">bad_student</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>
<details class="description">
      <summary class="btn btn-sm" data-open="Hide Output" data-close="Show Output"></summary>
        <p>
</p>
<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>

</div>

</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">

</div>

</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>Sequential (Input shape: 256 x 3 x 96 x 96)
============================================================================
Layer (type)         Output Shape         Param #    Trainable 
============================================================================
                     256 x 64 x 48 x 48  
Conv2d                                    9408       True      
BatchNorm2d                               128        True      
ReLU                                                           
____________________________________________________________________________
                     256 x 64 x 24 x 24  
MaxPool2d                                                      
Conv2d                                    36864      True      
BatchNorm2d                               128        True      
ReLU                                                           
Conv2d                                    36864      True      
BatchNorm2d                               128        True      
Conv2d                                    36864      True      
BatchNorm2d                               128        True      
ReLU                                                           
Conv2d                                    36864      True      
BatchNorm2d                               128        True      
____________________________________________________________________________
                     256 x 128 x 12 x 12 
Conv2d                                    73728      True      
BatchNorm2d                               256        True      
ReLU                                                           
Conv2d                                    147456     True      
BatchNorm2d                               256        True      
Conv2d                                    8192       True      
BatchNorm2d                               256        True      
Conv2d                                    147456     True      
BatchNorm2d                               256        True      
ReLU                                                           
Conv2d                                    147456     True      
BatchNorm2d                               256        True      
____________________________________________________________________________
                     256 x 256 x 6 x 6   
Conv2d                                    294912     True      
BatchNorm2d                               512        True      
ReLU                                                           
Conv2d                                    589824     True      
BatchNorm2d                               512        True      
Conv2d                                    32768      True      
BatchNorm2d                               512        True      
Conv2d                                    589824     True      
BatchNorm2d                               512        True      
ReLU                                                           
Conv2d                                    589824     True      
BatchNorm2d                               512        True      
____________________________________________________________________________
                     256 x 512 x 3 x 3   
Conv2d                                    1179648    True      
BatchNorm2d                               1024       True      
ReLU                                                           
Conv2d                                    2359296    True      
BatchNorm2d                               1024       True      
Conv2d                                    131072     True      
BatchNorm2d                               1024       True      
Conv2d                                    2359296    True      
BatchNorm2d                               1024       True      
ReLU                                                           
Conv2d                                    2359296    True      
BatchNorm2d                               1024       True      
____________________________________________________________________________
                     256 x 512 x 1 x 1   
AdaptiveAvgPool2d                                              
AdaptiveMaxPool2d                                              
____________________________________________________________________________
                     256 x 1024          
Flatten                                                        
BatchNorm1d                               2048       True      
Dropout                                                        
____________________________________________________________________________
                     256 x 512           
Linear                                    524288     True      
ReLU                                                           
BatchNorm1d                               1024       True      
Dropout                                                        
____________________________________________________________________________
                     256 x 43            
Linear                                    22016      True      
____________________________________________________________________________

Total params: 11,725,888
Total trainable params: 11,725,888
Total non-trainable params: 0

Optimizer used: &lt;function Adam at 0x7fa08117a3b0&gt;
Loss function: FlattenedLoss of CrossEntropyLoss()

Callbacks:
  - TrainEvalCallback
  - Recorder
  - ProgressCallback</pre>
</div>

</div>

</div>
</div>

    </details>
</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>But this would unfreeze the whole student! We don't want that, we would like to have the earlier pretrained layers of the model (the <strong>body</strong>) frozen and the rest (the <strong>head</strong>) to be trainable. The reason is that, by default, <code>Learner</code> does not freeze any parameter group.</p>
<p>So let's freeze the body. To do that we use the <code>freeze_to(n)</code> method where <strong>n</strong> is the number of parameter groups we want to freeze. We take n=1 as we only want the body to be frozen.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="n">bad_student</span><span class="o">.</span><span class="n">freeze_to</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

<span class="n">bad_student</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>
<details class="description">
      <summary class="btn btn-sm" data-open="Hide Output" data-close="Show Output"></summary>
        <p>
</p>
<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>/usr/local/lib/python3.7/dist-packages/fastai/optimizer.py:22: UserWarning: Freezing 1 groups; model has 1; whole model is frozen.
  warn(f"Freezing {self.frozen_idx} groups; model has {len(self.param_lists)}; whole model is frozen.")
</pre>
</div>
</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>

</div>

</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">

</div>

</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>Sequential (Input shape: 256 x 3 x 96 x 96)
============================================================================
Layer (type)         Output Shape         Param #    Trainable 
============================================================================
                     256 x 64 x 48 x 48  
Conv2d                                    9408       False     
BatchNorm2d                               128        True      
ReLU                                                           
____________________________________________________________________________
                     256 x 64 x 24 x 24  
MaxPool2d                                                      
Conv2d                                    36864      False     
BatchNorm2d                               128        True      
ReLU                                                           
Conv2d                                    36864      False     
BatchNorm2d                               128        True      
Conv2d                                    36864      False     
BatchNorm2d                               128        True      
ReLU                                                           
Conv2d                                    36864      False     
BatchNorm2d                               128        True      
____________________________________________________________________________
                     256 x 128 x 12 x 12 
Conv2d                                    73728      False     
BatchNorm2d                               256        True      
ReLU                                                           
Conv2d                                    147456     False     
BatchNorm2d                               256        True      
Conv2d                                    8192       False     
BatchNorm2d                               256        True      
Conv2d                                    147456     False     
BatchNorm2d                               256        True      
ReLU                                                           
Conv2d                                    147456     False     
BatchNorm2d                               256        True      
____________________________________________________________________________
                     256 x 256 x 6 x 6   
Conv2d                                    294912     False     
BatchNorm2d                               512        True      
ReLU                                                           
Conv2d                                    589824     False     
BatchNorm2d                               512        True      
Conv2d                                    32768      False     
BatchNorm2d                               512        True      
Conv2d                                    589824     False     
BatchNorm2d                               512        True      
ReLU                                                           
Conv2d                                    589824     False     
BatchNorm2d                               512        True      
____________________________________________________________________________
                     256 x 512 x 3 x 3   
Conv2d                                    1179648    False     
BatchNorm2d                               1024       True      
ReLU                                                           
Conv2d                                    2359296    False     
BatchNorm2d                               1024       True      
Conv2d                                    131072     False     
BatchNorm2d                               1024       True      
Conv2d                                    2359296    False     
BatchNorm2d                               1024       True      
ReLU                                                           
Conv2d                                    2359296    False     
BatchNorm2d                               1024       True      
____________________________________________________________________________
                     256 x 512 x 1 x 1   
AdaptiveAvgPool2d                                              
AdaptiveMaxPool2d                                              
____________________________________________________________________________
                     256 x 1024          
Flatten                                                        
BatchNorm1d                               2048       True      
Dropout                                                        
____________________________________________________________________________
                     256 x 512           
Linear                                    524288     False     
ReLU                                                           
BatchNorm1d                               1024       True      
Dropout                                                        
____________________________________________________________________________
                     256 x 43            
Linear                                    22016      False     
____________________________________________________________________________

Total params: 11,725,888
Total trainable params: 12,672
Total non-trainable params: 11,713,216

Optimizer used: &lt;function Adam at 0x7fa08117a3b0&gt;
Loss function: FlattenedLoss of CrossEntropyLoss()

Model frozen up to parameter group #1

Callbacks:
  - TrainEvalCallback
  - Recorder
  - ProgressCallback</pre>
</div>

</div>

</div>
</div>

    </details>
</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Now we have frozen the entire model! ü•∂
</p>
<div class="flash">
    <svg class="octicon octicon-info" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M8 1.5a6.5 6.5 0 100 13 6.5 6.5 0 000-13zM0 8a8 8 0 1116 0A8 8 0 010 8zm6.5-.25A.75.75 0 017.25 7h1a.75.75 0 01.75.75v2.75h.25a.75.75 0 010 1.5h-2a.75.75 0 010-1.5h.25v-2h-.25a.75.75 0 01-.75-.75zM8 6a1 1 0 100-2 1 1 0 000 2z"></path></svg>
    <strong>Note: </strong>The BatchNorm2d layers are never frozen, this is why we have some trainable parameters.
</div>
If we look at the warning at the top of the output, we can see the problem. We only have one parameter group which is the entire model.
<p>So, how are those parameters groups chosen? By the argument <code>splitter</code>, which by default is <code>trainable_parameters</code>. This will return all the trainable parameters of the model. In our case, they are all trainable, so we will only get one parameter group, hence the whole student will be frozen.</p>
<p>The solution is to pass <code>splitter=default_split</code>. This will split the parameter groups in body and head, just as we want!</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p></p>
<div class="flash flash-warn">
    <svg class="octicon octicon-zap" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M10.561 1.5a.016.016 0 00-.01.004L3.286 8.571A.25.25 0 003.462 9H6.75a.75.75 0 01.694 1.034l-1.713 4.188 6.982-6.793A.25.25 0 0012.538 7H9.25a.75.75 0 01-.683-1.06l2.008-4.418.003-.006a.02.02 0 00-.004-.009.02.02 0 00-.006-.006L10.56 1.5zM9.504.43a1.516 1.516 0 012.437 1.713L10.415 5.5h2.123c1.57 0 2.346 1.909 1.22 3.004l-7.34 7.142a1.25 1.25 0 01-.871.354h-.302a1.25 1.25 0 01-1.157-1.723L5.633 10.5H3.462c-1.57 0-2.346-1.909-1.22-3.004L9.503.429z"></path></svg>
    <strong>Important: </strong>In the <strong>Explore Training</strong> section we will use <code>lr_find()</code>, which does not accept any <em>weight decay</em> nor  <em>callback</em> arguments (it takes the ones defined when creating the Learner). Then the correct thing to do is to pass as an argument to the learner the <code>KnowledgeDistillation</code> callback, as we do with the <em>weight decay</em>. By doing so we have thesame training scenario when doing  <code>lr_find()</code> and <code>fit_one_cycle()</code>.
</div>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="n">loss</span> <span class="o">=</span> <span class="n">partial</span><span class="p">(</span><span class="n">SoftTarget</span><span class="p">,</span> <span class="n">T</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">kd</span> <span class="o">=</span> <span class="n">KnowledgeDistillation</span><span class="p">(</span><span class="n">teacher</span><span class="p">,</span> <span class="n">loss</span><span class="p">,</span> <span class="n">from_learner</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="n">student</span> <span class="o">=</span> <span class="n">Learner</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">student_model</span><span class="p">,</span> <span class="n">metrics</span><span class="o">=</span><span class="p">[</span><span class="n">accuracy</span><span class="p">,</span><span class="n">f1_score_mult</span><span class="p">],</span> <span class="n">splitter</span><span class="o">=</span><span class="n">default_split</span><span class="p">,</span> <span class="n">wd</span><span class="o">=</span><span class="n">wd</span><span class="p">,</span> <span class="n">cbs</span><span class="o">=</span><span class="n">kd</span><span class="p">)</span>
<span class="n">student</span><span class="o">.</span><span class="n">freeze_to</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="c1">#student.summary()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p></p>
<div class="flash flash-error">
    <svg class="octicon octicon-alert" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M8.22 1.754a.25.25 0 00-.44 0L1.698 13.132a.25.25 0 00.22.368h12.164a.25.25 0 00.22-.368L8.22 1.754zm-1.763-.707c.659-1.234 2.427-1.234 3.086 0l6.082 11.378A1.75 1.75 0 0114.082 15H1.918a1.75 1.75 0 01-1.543-2.575L6.457 1.047zM9 11a1 1 0 11-2 0 1 1 0 012 0zm-.25-5.25a.75.75 0 00-1.5 0v2.5a.75.75 0 001.5 0v-2.5z"></path></svg>
    <strong>Warning: </strong>If you use <code>student.summary()</code> it will raise the following error:
</div>
<em>Exception occured in <code>KnowledgeDistillation</code> when calling event <code>after_loss</code>:
  cross_entropy_loss(): argument 'target' (position 2) must be Tensor, not NoneType.</em>
Although, it only affect to the summary method. So we can continue and if we really want to check the learner we can remove and add back the callback, as the collapsed code shows below.

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<details class="description">
      <summary class="btn btn-sm" data-open="Hide Code" data-close="Show Code"></summary>
        <p></p>
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">'See in which position the KnowledgeDistillation is:'</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">student</span><span class="o">.</span><span class="n">cbs</span><span class="p">)</span>
<span class="nb">print</span><span class="p">()</span>

<span class="n">student</span><span class="o">.</span><span class="n">remove_cb</span><span class="p">(</span><span class="n">cb</span><span class="o">=</span><span class="n">student</span><span class="o">.</span><span class="n">cbs</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span> <span class="c1"># We could also do cb=kd</span>

<span class="nb">print</span><span class="p">(</span><span class="n">student</span><span class="o">.</span><span class="n">summary</span><span class="p">())</span> <span class="c1"># Obviously you won't see the KnowledgeDistillation callback at the end</span>

<span class="n">student</span><span class="o">.</span><span class="n">add_cb</span><span class="p">(</span><span class="n">cb</span><span class="o">=</span><span class="n">kd</span><span class="p">)</span> <span class="c1"># Add back the callback</span>

<span class="nb">print</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">'Check that you have the same list as before the summary:'</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">student</span><span class="o">.</span><span class="n">cbs</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

    </details>
<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>See in which position the KnowledgeDistillation is:
[TrainEvalCallback, Recorder, ProgressCallback, KnowledgeDistillation]

</pre>
</div>
</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>

</div>

</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">

</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Sequential (Input shape: 256 x 3 x 96 x 96)
============================================================================
Layer (type)         Output Shape         Param #    Trainable 
============================================================================
                     256 x 64 x 48 x 48  
Conv2d                                    9408       False     
BatchNorm2d                               128        True      
ReLU                                                           
____________________________________________________________________________
                     256 x 64 x 24 x 24  
MaxPool2d                                                      
Conv2d                                    36864      False     
BatchNorm2d                               128        True      
ReLU                                                           
Conv2d                                    36864      False     
BatchNorm2d                               128        True      
Conv2d                                    36864      False     
BatchNorm2d                               128        True      
ReLU                                                           
Conv2d                                    36864      False     
BatchNorm2d                               128        True      
____________________________________________________________________________
                     256 x 128 x 12 x 12 
Conv2d                                    73728      False     
BatchNorm2d                               256        True      
ReLU                                                           
Conv2d                                    147456     False     
BatchNorm2d                               256        True      
Conv2d                                    8192       False     
BatchNorm2d                               256        True      
Conv2d                                    147456     False     
BatchNorm2d                               256        True      
ReLU                                                           
Conv2d                                    147456     False     
BatchNorm2d                               256        True      
____________________________________________________________________________
                     256 x 256 x 6 x 6   
Conv2d                                    294912     False     
BatchNorm2d                               512        True      
ReLU                                                           
Conv2d                                    589824     False     
BatchNorm2d                               512        True      
Conv2d                                    32768      False     
BatchNorm2d                               512        True      
Conv2d                                    589824     False     
BatchNorm2d                               512        True      
ReLU                                                           
Conv2d                                    589824     False     
BatchNorm2d                               512        True      
____________________________________________________________________________
                     256 x 512 x 3 x 3   
Conv2d                                    1179648    False     
BatchNorm2d                               1024       True      
ReLU                                                           
Conv2d                                    2359296    False     
BatchNorm2d                               1024       True      
Conv2d                                    131072     False     
BatchNorm2d                               1024       True      
Conv2d                                    2359296    False     
BatchNorm2d                               1024       True      
ReLU                                                           
Conv2d                                    2359296    False     
BatchNorm2d                               1024       True      
____________________________________________________________________________
                     256 x 512 x 1 x 1   
AdaptiveAvgPool2d                                              
AdaptiveMaxPool2d                                              
____________________________________________________________________________
                     256 x 1024          
Flatten                                                        
BatchNorm1d                               2048       True      
Dropout                                                        
____________________________________________________________________________
                     256 x 512           
Linear                                    524288     True      
ReLU                                                           
BatchNorm1d                               1024       True      
Dropout                                                        
____________________________________________________________________________
                     256 x 43            
Linear                                    22016      True      
____________________________________________________________________________

Total params: 11,725,888
Total trainable params: 558,976
Total non-trainable params: 11,166,912

Optimizer used: &lt;function Adam at 0x7fa08117a3b0&gt;
Loss function: FlattenedLoss of CrossEntropyLoss()

Model frozen up to parameter group #1

Callbacks:
  - TrainEvalCallback
  - Recorder
  - ProgressCallback

Check that you have the same list as before the summary:
[TrainEvalCallback, Recorder, ProgressCallback, KnowledgeDistillation]
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Training">
<a class="anchor" href="#Training" aria-hidden="true"><span class="octicon octicon-link"></span></a>Training<a class="anchor-link" href="#Training"> </a>
</h1>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>In the training process is where <strong>FasterAI</strong> magic comes in üßô</p>
<p>Only by adding the <code>KnowledgeDistillation</code> callback when fitting the model, we will be able to use this technique with almost the same code as in the <a href="https://xanaga.github.io/posts_en/fastai/computer%20vision/traffic%20sign/2022/04/21/ResNet_for_Traffic_Sign_Classification_With_PyTorch.html">previous post</a>. But, as we setted those parameters when creating the <code>Learner()</code>, we don't even need to do that!üéâ</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Explore-training">
<a class="anchor" href="#Explore-training" aria-hidden="true"><span class="octicon octicon-link"></span></a>Explore training<a class="anchor-link" href="#Explore-training"> </a>
</h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We will follow the same procedure as is the <a href="https://xanaga.github.io/posts_en/fastai/computer%20vision/traffic%20sign/2022/04/21/ResNet_for_Traffic_Sign_Classification_With_PyTorch.html">previous post</a> for finding the hyperparameters that better train our model.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p></p>
<div class="flash flash-error">
    <svg class="octicon octicon-alert" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M8.22 1.754a.25.25 0 00-.44 0L1.698 13.132a.25.25 0 00.22.368h12.164a.25.25 0 00.22-.368L8.22 1.754zm-1.763-.707c.659-1.234 2.427-1.234 3.086 0l6.082 11.378A1.75 1.75 0 0114.082 15H1.918a1.75 1.75 0 01-1.543-2.575L6.457 1.047zM9 11a1 1 0 11-2 0 1 1 0 012 0zm-.25-5.25a.75.75 0 00-1.5 0v2.5a.75.75 0 001.5 0v-2.5z"></path></svg>
    <strong>Warning: </strong>The following code cells aim to illustrate the procedure of how to find a good learning rate. In practice we made more experiments, so you are encouraged to change the values in these cells to see how the training behaves. Don‚Äôt be afraid to overfit as this will not be the final model. You can set a large number of iterations to see when it starts overfitting so you can train the final model in a more informed way in the next section.
</div>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p></p>
<div class="flash">
    <svg class="octicon octicon-info" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M8 1.5a6.5 6.5 0 100 13 6.5 6.5 0 000-13zM0 8a8 8 0 1116 0A8 8 0 010 8zm6.5-.25A.75.75 0 017.25 7h1a.75.75 0 01.75.75v2.75h.25a.75.75 0 010 1.5h-2a.75.75 0 010-1.5h.25v-2h-.25a.75.75 0 01-.75-.75zM8 6a1 1 0 100-2 1 1 0 000 2z"></path></svg>
    <strong>Note: </strong>Remember that the <em>weight decay</em> and the <em>Knowledge Distillation Callback</em> where setted in the <code>Learner()</code> definition.
</div>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="n">student</span><span class="o">.</span><span class="n">lr_find</span><span class="p">()</span> <span class="c1"># wd and callback included</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>

</div>

</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">

</div>

</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>SuggestedLRs(valley=0.004365158267319202)</pre>
</div>

</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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%0A">
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="n">student</span><span class="o">.</span><span class="n">fit_one_cycle</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">lr_max</span><span class="o">=</span><span class="mf">0.001</span><span class="p">)</span> <span class="c1"># wd and cbs are setted in Learner()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>

</div>

</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: left;">
      <th>epoch</th>
      <th>train_loss</th>
      <th>valid_loss</th>
      <th>accuracy</th>
      <th>fbeta_score</th>
      <th>time</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>15.465137</td>
      <td>13.668188</td>
      <td>0.605898</td>
      <td>0.563930</td>
      <td>01:35</td>
    </tr>
  </tbody>
</table>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="n">student</span><span class="o">.</span><span class="n">unfreeze</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="n">student</span><span class="o">.</span><span class="n">lr_find</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>

</div>

</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">

</div>

</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>SuggestedLRs(valley=0.00019054606673307717)</pre>
</div>

</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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%0A">
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="n">student</span><span class="o">.</span><span class="n">fit_one_cycle</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="n">lr_max</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="mf">0.0001</span><span class="p">,</span> <span class="mf">0.001</span><span class="p">))</span> <span class="c1">#, wd=wd, cbs=kd)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>

</div>

</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: left;">
      <th>epoch</th>
      <th>train_loss</th>
      <th>valid_loss</th>
      <th>accuracy</th>
      <th>fbeta_score</th>
      <th>time</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>9.225066</td>
      <td>6.410910</td>
      <td>0.833745</td>
      <td>0.821246</td>
      <td>01:41</td>
    </tr>
    <tr>
      <td>1</td>
      <td>4.279030</td>
      <td>1.822614</td>
      <td>0.960905</td>
      <td>0.957461</td>
      <td>01:36</td>
    </tr>
    <tr>
      <td>2</td>
      <td>2.453992</td>
      <td>1.222131</td>
      <td>0.974760</td>
      <td>0.972952</td>
      <td>01:37</td>
    </tr>
    <tr>
      <td>3</td>
      <td>1.889181</td>
      <td>0.925809</td>
      <td>0.982579</td>
      <td>0.981159</td>
      <td>01:37</td>
    </tr>
    <tr>
      <td>4</td>
      <td>1.645638</td>
      <td>0.775705</td>
      <td>0.988889</td>
      <td>0.988514</td>
      <td>01:37</td>
    </tr>
    <tr>
      <td>5</td>
      <td>1.506031</td>
      <td>0.679071</td>
      <td>0.989575</td>
      <td>0.989230</td>
      <td>01:37</td>
    </tr>
    <tr>
      <td>6</td>
      <td>1.422567</td>
      <td>0.668275</td>
      <td>0.990809</td>
      <td>0.990585</td>
      <td>01:36</td>
    </tr>
    <tr>
      <td>7</td>
      <td>1.355428</td>
      <td>0.612182</td>
      <td>0.991632</td>
      <td>0.991374</td>
      <td>01:36</td>
    </tr>
    <tr>
      <td>8</td>
      <td>1.323943</td>
      <td>0.623958</td>
      <td>0.991495</td>
      <td>0.991259</td>
      <td>01:37</td>
    </tr>
  </tbody>
</table>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="n">student</span><span class="o">.</span><span class="n">lr_find</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>

</div>

</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">

</div>

</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>SuggestedLRs(valley=1.5848931980144698e-06)</pre>
</div>

</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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%0A">
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="n">student</span><span class="o">.</span><span class="n">fit_one_cycle</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="n">lr_max</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="mf">0.00001</span><span class="p">,</span> <span class="mf">0.0001</span><span class="p">))</span><span class="c1">#, wd=wd, cbs=kd)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>

</div>

</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: left;">
      <th>epoch</th>
      <th>train_loss</th>
      <th>valid_loss</th>
      <th>accuracy</th>
      <th>fbeta_score</th>
      <th>time</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>1.322057</td>
      <td>0.606176</td>
      <td>0.991770</td>
      <td>0.991487</td>
      <td>01:37</td>
    </tr>
    <tr>
      <td>1</td>
      <td>1.320874</td>
      <td>0.618872</td>
      <td>0.990535</td>
      <td>0.990247</td>
      <td>01:36</td>
    </tr>
    <tr>
      <td>2</td>
      <td>1.300413</td>
      <td>0.615932</td>
      <td>0.992730</td>
      <td>0.992584</td>
      <td>01:36</td>
    </tr>
    <tr>
      <td>3</td>
      <td>1.300726</td>
      <td>0.611663</td>
      <td>0.992455</td>
      <td>0.992312</td>
      <td>01:36</td>
    </tr>
    <tr>
      <td>4</td>
      <td>1.290397</td>
      <td>0.592799</td>
      <td>0.992455</td>
      <td>0.992310</td>
      <td>01:37</td>
    </tr>
    <tr>
      <td>5</td>
      <td>1.286910</td>
      <td>0.597255</td>
      <td>0.992455</td>
      <td>0.992296</td>
      <td>01:37</td>
    </tr>
  </tbody>
</table>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Retrain-on-the-whole-dataset">
<a class="anchor" href="#Retrain-on-the-whole-dataset" aria-hidden="true"><span class="octicon octicon-link"></span></a>Retrain on the whole dataset<a class="anchor-link" href="#Retrain-on-the-whole-dataset"> </a>
</h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Once we know which configuration is better we can train the model on all the data available (training+validation).</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="n">ImageDataLoaders</span><span class="o">.</span><span class="n">from_folder</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">item_tfms</span><span class="o">=</span><span class="p">[</span><span class="n">Resize</span><span class="p">(</span><span class="n">sz</span><span class="p">,</span><span class="n">order</span><span class="o">=</span><span class="mi">0</span><span class="p">)],</span> <span class="n">bs</span><span class="o">=</span><span class="mi">256</span><span class="p">,</span> 
                                    <span class="n">batch_tfms</span><span class="o">=</span><span class="p">[</span><span class="o">*</span><span class="n">aug_transforms</span><span class="p">(</span><span class="n">do_flip</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                                              <span class="n">max_zoom</span><span class="o">=</span><span class="mf">1.2</span><span class="p">,</span>
                                                              <span class="n">max_rotate</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
                                                              <span class="n">max_lighting</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span>
                                                              <span class="n">p_lighting</span><span class="o">=</span><span class="mf">0.8</span><span class="p">),</span>
                                                <span class="n">Normalize</span><span class="o">.</span><span class="n">from_stats</span><span class="p">(</span><span class="o">*</span><span class="n">imagenet_stats</span><span class="p">)],</span>
                                    <span class="n">vocab</span><span class="o">=</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">43</span><span class="p">)],</span> <span class="n">train</span><span class="o">=</span><span class="s1">'all'</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="n">teacher</span> <span class="o">=</span> <span class="n">create_cnn_model</span><span class="p">(</span><span class="n">resnet34</span><span class="p">,</span> <span class="mi">43</span><span class="p">,</span> <span class="n">pretrained</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>
<span class="n">teacher</span><span class="o">.</span><span class="n">load_state_dict</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">path_to_model</span><span class="o">+</span><span class="s1">'resnet34_weights.pth'</span><span class="p">))</span>

<span class="n">student_model</span><span class="o">=</span><span class="n">create_cnn_model</span><span class="p">(</span><span class="n">resnet18</span><span class="p">,</span> <span class="mi">43</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>
<span class="n">student</span> <span class="o">=</span> <span class="n">Learner</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">student_model</span><span class="p">,</span> <span class="n">metrics</span><span class="o">=</span><span class="p">[</span><span class="n">accuracy</span><span class="p">,</span><span class="n">f1_score_mult</span><span class="p">],</span> <span class="n">splitter</span><span class="o">=</span><span class="n">default_split</span><span class="p">,</span> <span class="n">wd</span><span class="o">=</span><span class="n">wd</span><span class="p">,</span> <span class="n">cbs</span><span class="o">=</span><span class="n">kd</span><span class="p">)</span>
<span class="n">student</span><span class="o">.</span><span class="n">freeze_to</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="n">student</span><span class="o">.</span><span class="n">fit_one_cycle</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">lr_max</span><span class="o">=</span><span class="mf">0.001</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>

</div>

</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: left;">
      <th>epoch</th>
      <th>train_loss</th>
      <th>valid_loss</th>
      <th>accuracy</th>
      <th>fbeta_score</th>
      <th>time</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>13.978484</td>
      <td>11.242065</td>
      <td>0.715364</td>
      <td>0.683073</td>
      <td>01:49</td>
    </tr>
  </tbody>
</table>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="n">student</span><span class="o">.</span><span class="n">unfreeze</span><span class="p">()</span>
<span class="n">student</span><span class="o">.</span><span class="n">fit_one_cycle</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">lr_max</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="mf">0.0001</span><span class="p">,</span> <span class="mf">0.001</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>

</div>

</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: left;">
      <th>epoch</th>
      <th>train_loss</th>
      <th>valid_loss</th>
      <th>accuracy</th>
      <th>fbeta_score</th>
      <th>time</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>9.187653</td>
      <td>5.441027</td>
      <td>0.893416</td>
      <td>0.883363</td>
      <td>01:54</td>
    </tr>
    <tr>
      <td>1</td>
      <td>3.874919</td>
      <td>1.078969</td>
      <td>0.987106</td>
      <td>0.987011</td>
      <td>01:53</td>
    </tr>
    <tr>
      <td>2</td>
      <td>2.228036</td>
      <td>0.545888</td>
      <td>0.997257</td>
      <td>0.997255</td>
      <td>01:53</td>
    </tr>
    <tr>
      <td>3</td>
      <td>1.754988</td>
      <td>0.441869</td>
      <td>0.998080</td>
      <td>0.998076</td>
      <td>01:52</td>
    </tr>
    <tr>
      <td>4</td>
      <td>1.543820</td>
      <td>0.505094</td>
      <td>0.998903</td>
      <td>0.998900</td>
      <td>01:53</td>
    </tr>
    <tr>
      <td>5</td>
      <td>1.451698</td>
      <td>0.324294</td>
      <td>0.999726</td>
      <td>0.999725</td>
      <td>01:52</td>
    </tr>
    <tr>
      <td>6</td>
      <td>1.336454</td>
      <td>0.319012</td>
      <td>0.999863</td>
      <td>0.999863</td>
      <td>01:51</td>
    </tr>
    <tr>
      <td>7</td>
      <td>1.282818</td>
      <td>0.278213</td>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>01:51</td>
    </tr>
    <tr>
      <td>8</td>
      <td>1.239342</td>
      <td>0.259717</td>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>01:50</td>
    </tr>
    <tr>
      <td>9</td>
      <td>1.236298</td>
      <td>0.250886</td>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>01:51</td>
    </tr>
  </tbody>
</table>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="n">student</span><span class="o">.</span><span class="n">fit_one_cycle</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="n">lr_max</span><span class="o">=</span><span class="mf">0.0001</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>

</div>

</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: left;">
      <th>epoch</th>
      <th>train_loss</th>
      <th>valid_loss</th>
      <th>accuracy</th>
      <th>fbeta_score</th>
      <th>time</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>1.270205</td>
      <td>0.312592</td>
      <td>0.999726</td>
      <td>0.999725</td>
      <td>01:50</td>
    </tr>
    <tr>
      <td>1</td>
      <td>1.336736</td>
      <td>0.343301</td>
      <td>0.999863</td>
      <td>0.999863</td>
      <td>01:51</td>
    </tr>
    <tr>
      <td>2</td>
      <td>1.285208</td>
      <td>0.289410</td>
      <td>0.999863</td>
      <td>0.999863</td>
      <td>01:50</td>
    </tr>
    <tr>
      <td>3</td>
      <td>1.217801</td>
      <td>0.267841</td>
      <td>0.999863</td>
      <td>0.999863</td>
      <td>01:51</td>
    </tr>
    <tr>
      <td>4</td>
      <td>1.179426</td>
      <td>0.231982</td>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>01:51</td>
    </tr>
    <tr>
      <td>5</td>
      <td>1.172143</td>
      <td>0.221064</td>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>01:50</td>
    </tr>
  </tbody>
</table>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Test">
<a class="anchor" href="#Test" aria-hidden="true"><span class="octicon octicon-link"></span></a>Test<a class="anchor-link" href="#Test"> </a>
</h1>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Like we did in the <a href="https://xanaga.github.io/posts_en/fastai/computer%20vision/traffic%20sign/2022/04/21/ResNet_for_Traffic_Sign_Classification_With_PyTorch.html">previous post</a> we will use Test Time Augmentations, and we will use the same function to plot how the performance and inference time behave.
</p>
<div class="flash">
    <svg class="octicon octicon-info" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M8 1.5a6.5 6.5 0 100 13 6.5 6.5 0 000-13zM0 8a8 8 0 1116 0A8 8 0 010 8zm6.5-.25A.75.75 0 017.25 7h1a.75.75 0 01.75.75v2.75h.25a.75.75 0 010 1.5h-2a.75.75 0 010-1.5h.25v-2h-.25a.75.75 0 01-.75-.75zM8 6a1 1 0 100-2 1 1 0 000 2z"></path></svg>
    <strong>Note: </strong>We have added to the <code>test_time_aug</code> function  the <code>mask</code> argument. This will allow us to compute the F1-score only for some classes. For example, only for the ones we have trained on.
</div>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="k">def</span> <span class="nf">test_time_aug</span><span class="p">(</span><span class="n">learner</span><span class="p">,</span> <span class="n">test_dataloader</span><span class="p">,</span> <span class="n">y_true</span><span class="p">,</span> <span class="n">metric</span><span class="p">,</span> <span class="n">n_augs</span><span class="o">=</span><span class="p">[</span><span class="mi">10</span><span class="p">],</span> <span class="n">beta</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span><span class="n">mask</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="n">res</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">if</span> <span class="n">mask</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
      <span class="n">mask</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">y_true</span><span class="p">)))</span>

    <span class="n">learner</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span>

    <span class="k">for</span> <span class="n">aug</span> <span class="ow">in</span> <span class="n">n_augs</span><span class="p">:</span>

      <span class="k">if</span> <span class="n">aug</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">start</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
        <span class="n">log_preds</span><span class="p">,</span><span class="n">_</span> <span class="o">=</span> <span class="n">learner</span><span class="o">.</span><span class="n">get_preds</span><span class="p">(</span><span class="n">dl</span><span class="o">=</span><span class="n">test_dataloader</span><span class="p">)</span>
        <span class="n">end</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
        <span class="n">infer_time</span> <span class="o">=</span> <span class="n">end</span><span class="o">-</span><span class="n">start</span>
      <span class="k">else</span><span class="p">:</span>
        <span class="n">start</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
        <span class="n">log_preds</span><span class="p">,</span><span class="n">_</span> <span class="o">=</span> <span class="n">learner</span><span class="o">.</span><span class="n">tta</span><span class="p">(</span><span class="n">dl</span><span class="o">=</span><span class="n">test_dataloader</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="n">aug</span><span class="p">,</span> <span class="n">beta</span><span class="o">=</span><span class="n">beta</span><span class="p">)</span>
        <span class="n">end</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
        <span class="n">infer_time</span> <span class="o">=</span> <span class="n">end</span><span class="o">-</span><span class="n">start</span>

      <span class="n">preds</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">log_preds</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
      <span class="n">score</span> <span class="o">=</span> <span class="n">metric</span><span class="p">(</span><span class="n">preds</span><span class="p">[</span><span class="n">mask</span><span class="p">],</span> <span class="n">y_true</span><span class="p">[</span><span class="n">mask</span><span class="p">])</span>

      <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">aug</span><span class="p">,</span> <span class="n">score</span><span class="p">,</span><span class="n">infer_time</span><span class="p">])</span>

      <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">'N Augmentations: </span><span class="si">{</span><span class="n">aug</span><span class="si">}</span><span class="se">\t</span><span class="s1">F1-score: </span><span class="si">{</span><span class="n">score</span><span class="si">}</span><span class="se">\t</span><span class="s1">Time:</span><span class="si">{</span><span class="n">infer_time</span><span class="si">}</span><span class="s1">'</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">res</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">'n_aug'</span><span class="p">,</span> <span class="s1">'score'</span><span class="p">,</span> <span class="s1">'time'</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="n">true_test_labels</span> <span class="o">=</span> <span class="p">{</span><span class="n">a</span><span class="o">.</span><span class="n">filename</span><span class="p">:</span> <span class="n">a</span><span class="o">.</span><span class="n">label</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">test_annotations</span><span class="p">}</span>
<span class="n">class_indexes</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">vocab</span><span class="o">.</span><span class="n">o2i</span>
<span class="n">test_img</span><span class="o">=</span><span class="n">get_image_files</span><span class="p">(</span><span class="s1">'./data/test'</span><span class="p">)</span>
<span class="n">filenames</span> <span class="o">=</span> <span class="p">[</span><span class="n">filepath</span><span class="o">.</span><span class="n">name</span> <span class="k">for</span> <span class="n">filepath</span> <span class="ow">in</span> <span class="n">test_img</span><span class="p">]</span>
<span class="n">labels</span> <span class="o">=</span> <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">true_test_labels</span><span class="p">[</span><span class="n">filename</span><span class="p">])</span> <span class="k">for</span> <span class="n">filename</span> <span class="ow">in</span> <span class="n">filenames</span><span class="p">]</span>
<span class="n">y_true</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">class_indexes</span><span class="p">[</span><span class="n">label</span><span class="p">]</span> <span class="k">for</span> <span class="n">label</span> <span class="ow">in</span> <span class="n">labels</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="n">test_dataloader</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">test_dl</span><span class="p">(</span><span class="n">test_img</span><span class="p">,</span> <span class="n">bs</span><span class="o">=</span><span class="mi">256</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The following code will create the mask used for computing the F1-score. You only have to specify in which classes you want to focus on the <code>interest_classes</code> variable. We will focus on all the classes that we trained with (which are all the classes).</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="n">interest_classes</span><span class="o">=</span><span class="n">c</span> 
<span class="n">interest_idx</span><span class="o">=</span><span class="p">[</span><span class="n">data</span><span class="o">.</span><span class="n">vocab</span><span class="o">.</span><span class="n">o2i</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">cl</span><span class="p">)]</span> <span class="k">for</span> <span class="n">cl</span> <span class="ow">in</span> <span class="n">interest_classes</span><span class="p">]</span>
<span class="n">mask</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">interest_idx</span><span class="p">,</span> <span class="n">invert</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p></p>
<div class="flash">
    <svg class="octicon octicon-info" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M8 1.5a6.5 6.5 0 100 13 6.5 6.5 0 000-13zM0 8a8 8 0 1116 0A8 8 0 010 8zm6.5-.25A.75.75 0 017.25 7h1a.75.75 0 01.75.75v2.75h.25a.75.75 0 010 1.5h-2a.75.75 0 010-1.5h.25v-2h-.25a.75.75 0 01-.75-.75zM8 6a1 1 0 100-2 1 1 0 000 2z"></path></svg>
    <strong>Note: </strong>If you set <code>invert</code> to <code>True</code> you will get the F1-score only on the images you have not seen in the training.
</div>
If we try to use our learner for as it is we will get an error, produced by the <code>KnowledgeDistallation</code> callback. But we don't need it anymore! (sorry Nathan, you've been a hero üòî). Let's remove it.

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="n">student</span><span class="o">.</span><span class="n">cbs</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(#4) [TrainEvalCallback,Recorder,ProgressCallback,KnowledgeDistillation]</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="n">student</span><span class="o">.</span><span class="n">cbs</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>KnowledgeDistillation</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="n">student</span><span class="o">.</span><span class="n">remove_cb</span><span class="p">(</span><span class="n">cb</span><span class="o">=</span><span class="n">student</span><span class="o">.</span><span class="n">cbs</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
<span class="n">student</span><span class="o">.</span><span class="n">cbs</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(#3) [TrainEvalCallback,Recorder,ProgressCallback]</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="n">metric</span> <span class="o">=</span> <span class="n">partial</span><span class="p">(</span><span class="n">f1_score</span><span class="p">,</span> <span class="n">average</span><span class="o">=</span><span class="s1">'weighted'</span><span class="p">)</span>

<span class="n">results</span> <span class="o">=</span> <span class="n">test_time_aug</span><span class="p">(</span><span class="n">student</span><span class="p">,</span> <span class="n">test_dataloader</span><span class="p">,</span> <span class="n">y_true</span><span class="p">,</span> <span class="n">metric</span><span class="p">,</span> <span class="n">n_augs</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">30</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>

</div>

</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">

</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>N Augmentations: 0	F1-score: 0.9922140340549594	Time:24.077036380767822
</pre>
</div>
</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>

</div>

</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">

    <div>
      <progress value="0" class="" max="6" style="width:300px; height:20px; vertical-align: middle;"></progress>
      
    </div>
    

</div>

</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>

</div>

</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">

</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>N Augmentations: 5	F1-score: 0.9933502950176439	Time:117.72993874549866
</pre>
</div>
</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>

</div>

</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">

    <div>
      <progress value="0" class="" max="6" style="width:300px; height:20px; vertical-align: middle;"></progress>
      
    </div>
    

</div>

</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>

</div>

</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">

</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>N Augmentations: 10	F1-score: 0.9943761367605225	Time:212.58393836021423
</pre>
</div>
</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>

</div>

</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">

    <div>
      <progress value="0" class="" max="6" style="width:300px; height:20px; vertical-align: middle;"></progress>
      
    </div>
    

</div>

</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>

</div>

</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">

</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>N Augmentations: 20	F1-score: 0.9950922306435893	Time:405.470721244812
</pre>
</div>
</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>

</div>

</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">

    <div>
      <progress value="0" class="" max="6" style="width:300px; height:20px; vertical-align: middle;"></progress>
      
    </div>
    

</div>

</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>

</div>

</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">

</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>N Augmentations: 30	F1-score: 0.9947694889306348	Time:592.3682796955109
</pre>
</div>
</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax1</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>

<span class="n">ax2</span> <span class="o">=</span> <span class="n">ax1</span><span class="o">.</span><span class="n">twinx</span><span class="p">()</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">results</span><span class="p">[</span><span class="s1">'n_aug'</span><span class="p">],</span> <span class="n">results</span><span class="p">[</span><span class="s1">'score'</span><span class="p">],</span> <span class="s1">'g-'</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">results</span><span class="p">[</span><span class="s1">'n_aug'</span><span class="p">],</span> <span class="n">results</span><span class="p">[</span><span class="s1">'time'</span><span class="p">],</span> <span class="s1">'b--'</span><span class="p">)</span>

<span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">'Number Augmentations'</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">'F1 score'</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">'g'</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">'Time (s)'</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">'b'</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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%0A">
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Conclusion">
<a class="anchor" href="#Conclusion" aria-hidden="true"><span class="octicon octicon-link"></span></a>Conclusion<a class="anchor-link" href="#Conclusion"> </a>
</h1>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>As we have seen Knowledge Distillation allows us to train for more epochs without overfitting and improves the final performance of the model compared with not using it (and getting very close of the resnet34, which resulted in 0.9963 F1-score). An intuitive explanation can be that we are giving more information to the network in every step of the backpropagation by, not only providing one-hot labels, but also a probability of the image to be another class. With this we are introducing the idea of similarities between classes.</p>
<p>I see these types of compression approaches as very interesting and I would like to apply them in other domains, maybe to NLP or 3D data. So I cannot recommend more <a href="https://nathanhubens.github.io/fasterai/">FasterAI</a> library and infinitely thank the work done to Nathan Hubens. Also, if you want to learn more about how to make smaller and faster Neural Networks I encourage you to visit his <a href="https://nathanhubens.github.io/posts/">blog</a>.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Thanks for reading!üòÄ</p>

</div>
</div>
</div>
</div>



  </div><!-- from https://github.com/utterance/utterances -->
<script src="https://utteranc.es/client.js"
        repo="XanaGA/posts_en"
        issue-term="title"
        label="blogpost-comment"
        theme="github-light"
        crossorigin="anonymous"
        async>
</script><a class="u-url" href="/posts_en/knowledgedistillation/fastai/computer%20vision/2022/04/24/Knowledge_Distillation.html" hidden></a>
</article>

      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/posts_en/"></data>

  <div class="wrapper">

    <div class="footer-col-wrapper">
      <div class="footer-col">
        <p class="feed-subscribe">
          <a href="/posts_en/feed.xml">
            <svg class="svg-icon orange">
              <use xlink:href="/posts_en/assets/minima-social-icons.svg#rss"></use>
            </svg><span>Subscribe</span>
          </a>
        </p>
      </div>
      <div class="footer-col">
        <p>A blog to document my journey through deep learning, computer graphics, VR/AR, BCI...</p>
      </div>
    </div>

    <div class="social-links"><ul class="social-media-list"><li><a rel="me" href="https://github.com/XanaGA" target="_blank" title="XanaGA"><svg class="svg-icon grey"><use xlink:href="/posts_en/assets/minima-social-icons.svg#github"></use></svg></a></li><li><a rel="me" href="https://twitter.com/XaviXva" target="_blank" title="XaviXva"><svg class="svg-icon grey"><use xlink:href="/posts_en/assets/minima-social-icons.svg#twitter"></use></svg></a></li></ul>
</div>

  </div>

</footer>
</body>

</html>
